import{j as e,L as u,Q as f,b as D,cw as E,a as R,cx as I,I as O,cE as F,cy as k,a3 as U,a4 as q,a5 as L,a6 as A,a7 as M,B as C,s as S,aE as H,e as B,T as G,D as V,E as W,ce as N}from"./main-BbYQSaQk.js";import{D as Q,a as X,b as Y,c as J}from"./dropdown-menu-YcYqpwYt.js";import{a as K}from"./use-update-user-preference-CBLGe2sw.js";import{c as y}from"./url-search-params-Wt6RBoj-.js";import{C as Z}from"./chevron-down-Curb5_nW.js";import{G as ee}from"./GitHub-CY1Qv8Sv.js";import{P as se,a as te,U as ae}from"./UserClickCard-BBMqA-IX.js";import{S as i}from"./skeleton-B0dkRAH3.js";import{f as re}from"./format-date-BncAflfy.js";import{a as p,R as le}from"./zod-BSuARh4v.js";import{C as ne,H as P,P as ie}from"./PaperFeedVotes-BqA6k5Wa.js";import{P as oe}from"./PaperSummary-Cta3hUJP.js";import{U as ce}from"./UserAvatar-BFkI3CpE.js";import{P as de}from"./PaperFeedBookmarks-BS_HFxoJ.js";import{m as me}from"./paper-DQXJ4A0A.js";import{u as xe}from"./useMutation-DzuApWMv.js";import{C as $}from"./code-xml-piwugkBw.js";import{T as ue}from"./trending-up-W2T_oQ6D.js";function Ue({currentTab:s}){const a=l=>{f(`${l}_tab_clicked`,{previous_tab:s})},r=l=>`/${l==="papers"?"":l}`;return e.jsx("div",{className:"flex items-center h-full",children:e.jsxs("div",{className:"flex bg-panel-light rounded-full p-1 h-full",children:[e.jsx(u,{href:r("papers"),"data-loading-trigger":"true",onClick:()=>a("papers"),className:`px-4 rounded-full text-sm cursor-pointer ${s==="papers"?"bg-bg text-custom-red":"text-text"}`,children:"Papers"}),e.jsx(u,{href:r("benchmarks"),"data-loading-trigger":"true",onClick:()=>a("benchmarks"),className:`px-4 rounded-full text-sm cursor-pointer ${s==="benchmarks"?"bg-bg text-custom-red":"text-text"}`,children:"Benchmarks"})]})})}function qe({currentTab:s}){const{data:a}=D(),r=a?.followingOrganizations??[],{data:l}=E(r),c=l??[],n=R(),t=s==="benchmarks"?["Hot","Views"]:F,x=n?.get("sort")??I(a),d=s==="benchmarks"&&!t.includes(x)?"Hot":x,h=t,j=o=>{if(n.size===0){const w=a?.followingTopics??[],m=w.filter(g=>k(g)==="subcategory"),T=w.filter(g=>k(g)==="custom-category"),z=c.map(g=>g.name),_=y({subcategories:m,"custom-categories":T,organizations:z,sort:[o]});return s==="benchmarks"?`/benchmarks?${_}`:`/?${_}`}const b=new URLSearchParams(n?.toString()),v=y({sort:[o]},b);return s==="benchmarks"?`/benchmarks?${v}`:`/?${v}`};return e.jsxs(Q,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center rounded-full border px-2.5 py-1",children:[e.jsx(O,{}),e.jsx("span",{className:"text-sm text-text",children:d}),e.jsx(Z,{className:"-mr-1 size-5 shrink-0 text-text"})]})}),e.jsx(Y,{children:h.map(o=>(a||o!="Recommended")&&e.jsx(J,{className:"p-0",children:e.jsx(u,{className:"cursor-pointer text-sm text-subtext-0 hover:text-text w-full px-2 py-1.5",href:j(o),onClick:()=>a&&K({base:{feedSort:o}}),"data-loading-trigger":"true",children:o})},o))})]})}const he=({paperGroupId:s,universalPaperId:a,paperTitle:r,variant:l="default"})=>{const{data:c}=D(),t=(c?.requestedImplementations??[]).includes(s),[x,d]=p.useState(!1),[h,j]=p.useState(""),{mutate:o}=xe(me(s)),b=()=>{t?o({universalPaperId:a,paperTitle:r??"Unknown Paper"}):d(!0)},v=()=>{f("paper_implementation_requested",{universal_paper_id:a,has_additional_info:!!h.trim()}),o({universalPaperId:a,paperTitle:r??"Unknown Paper",additionalInfo:h.trim()||void 0},{onSuccess:()=>{h.trim()&&S("Thank you! Your request has been sent","success")},onError:m=>{S(`Failed to send request. Error: ${m instanceof Error?m.message:m}`,"warning")}}),d(!1),j("")},w=()=>l==="compact"?e.jsx("button",{onClick:m=>{m.preventDefault(),b()},className:`inline-flex items-center gap-1.5 px-2 py-1 text-sm transition-colors ${t?"text-custom-red":"hover:text-custom-red text-subtext-0"}`,children:e.jsx($,{className:`${t?"text-custom-red fill-current":""} h-4 w-4`,strokeWidth:1.5})}):e.jsxs("button",{onClick:b,className:"md:text-md text-custom-red hover:border-custom-red hover:bg-custom-red/10 flex h-8 shrink-0 items-center gap-1.5 rounded-full px-3 text-sm transition-colors md:h-10 dark:text-white",children:[e.jsx($,{className:`${t?"fill-current":""} size-6 md:h-6 md:w-6`,strokeWidth:1.5}),e.jsx("p",{className:"text-[17px]",children:t?"Requested":"Implement"})]});return e.jsxs(e.Fragment,{children:[w(),e.jsx(U,{open:x,onOpenChange:d,children:e.jsxs(q,{children:[e.jsx(L,{children:e.jsxs(A,{className:"pr-8",children:["Request implementation"," ",r&&e.jsxs(e.Fragment,{children:["for ",e.jsx("em",{children:r})]})]})}),e.jsx("p",{className:"text-sm text-subtext-0",children:"We will be providing implementations and detailed result reproductions for requested papers! Let us know what you'd like to see implemented."}),e.jsx("textarea",{value:h,onChange:m=>j(m.target.value),placeholder:"Optional: Tell us more about what you'd like to see implemented...",className:"w-full rounded-sm border p-2 min-h-[100px]"}),e.jsxs(M,{children:[e.jsx(C,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(C,{onClick:v,children:"Done"})]})]})})]})},fe=({categories:s,enableLinks:a,highlight:r})=>{if(!s?.length)return null;const l=t=>t.type==="category"?`/?categories=${t.label}`:t.type==="subcategory"?`/?subcategories=${t.label}`:`/?custom-categories=${t.label}`,c=a?u:"span",n=r?s.filter(t=>r.includes(t)||r.includes(N[t]?.label??"NEVER")):s.slice(0,3);return r&&n.length<3&&n.push(...s.values().filter(t=>!r.includes(t)&&N[t]).take(3-n.length)),e.jsx("div",{className:"scrollbar-hide flex items-center overflow-x-auto",children:n.map(t=>N[t]).filter(Boolean).slice(0,3).map(t=>e.jsx(c,{className:"mr-2 flex shrink-0 rounded-full border border-surface-0 bg-bg px-2.5 py-0.5 text-[10px] font-light text-text transition-colors hover:bg-mantle hover:text-text sm:text-[11px]","data-loading-trigger":"true",onClick:()=>f("feed_category_clicked"),href:l(t),children:t.label},t.label))})},ge=({authors:s})=>s?.length?e.jsxs("div",{className:"flex items-center text-sm",children:[s.slice(0,2).map((a,r)=>e.jsxs(le.Fragment,{children:[r>0&&e.jsx("span",{className:"mx-2",children:"·"}),e.jsxs(se,{children:[e.jsx(te,{asChild:!0,children:e.jsxs("div",{className:"text-md flex cursor-pointer items-center gap-1.5 p-0.5 text-subtext-1 hover:text-text hover:underline",children:[e.jsx(ce,{className:"size-7 rounded-full",name:a.username,googleScholarID:a?.googleScholarId??void 0,avatar:a?.avatar??void 0}),a.realName]})}),e.jsx(ae,{user:a})]})]},a.id)),s.length>2&&e.jsxs("span",{className:"text-subtext-0",children:[" +",s.length-2]})]}):null,pe=({organizations:s,enableLinks:a})=>{if(!s?.length)return null;const r=a?u:"span";return e.jsx("div",{className:"scrollbar-hide flex items-center overflow-x-auto whitespace-nowrap",children:s.map(l=>e.jsxs(r,{href:`/?organizations=${l.name}`,onClick:()=>f("feed_organization_clicked"),"data-loading-trigger":"true",className:"mr-2 inline-flex shrink-0 items-center rounded-full border bg-bg px-2 py-1 text-xs font-normal text-text transition-colors hover:bg-surface-0",children:[l.image&&e.jsx("img",{src:`https://static.alphaxiv.org/${l.image}`,alt:`${l.name} logo`,className:"mr-1.5 size-4 dark:paper-invert"}),e.jsx("span",{className:"truncate",children:l.name})]},l.name))})},je=({paper:s,expandedAbstracts:a,setExpandedAbstracts:r,onVote:l,highlightTopics:c,disableFeedLinks:n})=>{const{current:t}=p.useRef({hasPrefetched:!1});return e.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row",onMouseEnter:()=>{},children:[s.image_url?.length&&e.jsxs("div",{className:"relative hidden shrink-0 lg:block",children:[e.jsx(u,{href:`/abs/${s.universal_paper_id}`,"data-loading-trigger":"true",target:n?"_blank":"_self",children:e.jsx("img",{src:`${H}/${s.image_url}`,alt:"Paper thumbnail",className:"dark:paper-invert w-56 max-w-full cursor-pointer rounded-lg object-cover ring-1 ring-surface-1/50"})}),e.jsx("div",{className:"absolute top-2 left-2 inline-flex items-center rounded-full bg-bg/95 px-2 py-1 text-xs text-subtext-0 shadow-xs ring-1 ring-surface-1/50",children:!!s.metrics.visits_count.all&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"h-3.5 w-3.5 text-subtext-0"}),s.metrics.visits_count.all.toLocaleString(),s.metrics.visits_count.last_7_days/s.metrics.visits_count.all>=.3&&e.jsx(ue,{className:"h-3.5 w-3.5 text-accent-green"})]})})]}),e.jsxs("div",{className:"flex max-w-full min-w-0 flex-1 flex-col",children:[e.jsxs("div",{className:"mb-2 flex w-full items-center gap-x-3 whitespace-nowrap",children:[e.jsx("div",{className:"text-[11px] text-subtext-0 sm:text-xs",children:re(s.publication_date)}),e.jsx("div",{className:"flex-1"}),(s.topics?.length||s.topics?.length)&&e.jsx(fe,{categories:s.topics,enableLinks:!n,highlight:c})]}),e.jsx("div",{className:"text-custom-red text-base leading-snug break-words hover:underline sm:text-lg",children:e.jsx(u,{href:`/abs/${s.universal_paper_id}`,"data-loading-trigger":"true",target:n?"_blank":"_self",children:e.jsx("h2",{children:e.jsx(P,{htmlText:{html:s.title},className:"text-custom-red! text-base! hover:underline sm:text-[22px]! dark:text-text! font-rubik"})})})}),s.organization_info&&s.organization_info.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx(pe,{organizations:s.organization_info,enableLinks:!n})}),s.author_info?.length>0&&e.jsx("div",{className:"my-2",children:e.jsx(ge,{authors:s.author_info})}),s.paper_summary?e.jsx(oe,{paperSummary:s.paper_summary,abstract:s.abstract,hideSections:!0}):e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"max-w-full",children:[e.jsx(P,{htmlText:{html:s.abstract},className:B("mt-2 text-xs break-words text-subtext-0 sm:text-sm",{"line-clamp-3":!a[s.universal_paper_id]})}),s.abstract?.split(" ").length>45&&e.jsx("button",{onClick:()=>{r(x=>{const d=!x[s.universal_paper_id];return f(d?"paper_abstract_expanded":"paper_abstract_collapsed"),{...x,[s.universal_paper_id]:d}})},className:"text-custom-red mt-1 text-[10px] hover:underline sm:text-xs dark:text-text",children:a[s.universal_paper_id]?"Show less":"Read more"})]})}),e.jsxs("div",{className:"mt-auto flex justify-end gap-x-6 pt-2",children:[e.jsx(de,{paperGroupId:s.paper_group_id,variant:"feed",buttonClassName:"flex h-8 items-center gap-1.5 rounded-full px-3 text-sm text-custom-red dark:text-white transition-colors hover:border-custom-red hover:bg-custom-red/10 md:h-10",iconClassName:"size-6 text-custom-red dark:text-white transition-colors md:h-6 md:w-6"}),!!(s.github_stars&&s.github_stars>0&&s.github_url)&&e.jsxs(G,{children:[e.jsx(V,{asChild:!0,children:e.jsxs("a",{href:s.github_url,target:"_blank",rel:"noopener noreferrer",className:"flex h-8 items-center gap-1.5 rounded-full px-3 text-sm text-text transition-colors hover:bg-surface-0 cursor-pointer md:h-10",onClick:()=>f("feed_github_clicked"),children:[e.jsx(ee,{className:"text-active-item size-5"}),e.jsx("span",{className:"text-active-item text-[17px]",children:s.github_stars.toLocaleString()})]})}),e.jsx(W,{children:e.jsx("p",{children:"GitHub Stars"})})]}),e.jsx(he,{paperGroupId:s.paper_group_id,universalPaperId:s.universal_paper_id,paperTitle:s.title}),e.jsx(ie,{totalVotes:s.metrics.total_votes,totalPublicVotes:s.metrics.public_total_votes,paperGroupId:s.paper_group_id,universalPaperId:s.universal_paper_id,onVote:l})]})]})]})},be=p.forwardRef(({paper:s,onVote:a,highlightTopics:r,disableFeedLinks:l},c)=>{const[n,t]=p.useState({});return e.jsx("div",{ref:c,className:"mb-6 flex flex-col rounded-xl border bg-panel p-3 text-left transition-all hover:shadow-sm",children:e.jsx(je,{paper:s,expandedAbstracts:n,setExpandedAbstracts:t,onVote:a,highlightTopics:r,disableFeedLinks:l})})});be.displayName="PaperFeedCard";const Le=()=>e.jsx("div",{className:"mb-6 flex flex-col rounded-xl border bg-bg p-3 text-left shadow-xs transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:[e.jsx("div",{className:"relative hidden shrink-0 lg:block",children:e.jsx(i,{className:"w-56 h-full max-w-full rounded-lg"})}),e.jsxs("div",{className:"flex max-w-full min-w-0 flex-1 flex-col",children:[e.jsxs("div",{className:"mb-2 flex w-full items-center gap-x-3 whitespace-nowrap",children:[e.jsx(i,{className:"h-[11px] sm:text-xs w-16"}),e.jsx("div",{className:"flex-grow-1"}),e.jsx(i,{className:"h-[11px] sm:text-xs w-20"}),e.jsx(i,{className:"h-[11px] sm:text-xs w-28"}),e.jsx(i,{className:"h-[11px] sm:text-xs w-24"})]}),e.jsx("h2",{children:e.jsx(i,{className:"text-base! sm:text-[22px]!",children:" "})}),e.jsxs("div",{className:"mt-2 flex flex-row",children:[e.jsx(i,{className:"rounded-full w-32 px-2 py-1 mr-2 text-xs",children:" "}),e.jsx(i,{className:"rounded-full w-12 px-2 py-1 mr-2 text-xs",children:" "}),e.jsx(i,{className:"rounded-full w-24 px-2 py-1 mr-2 text-xs",children:" "})]}),e.jsx(i,{className:"w-full h-28 mt-2"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(i,{className:"w-full h-7.5 mt-2 rounded-lg"}),e.jsx(i,{className:"w-full h-7.5 mt-2 rounded-lg"}),e.jsx(i,{className:"w-full h-7.5 mt-2 rounded-lg"}),e.jsx(i,{className:"w-full h-7.5 mt-2 rounded-lg"})]}),e.jsxs("div",{className:"mt-auto flex justify-end gap-x-6 pt-2",children:[e.jsx(i,{className:"w-40 h-10 rounded-full"}),e.jsx(i,{className:"w-20 h-10 rounded-full"})]})]})]})});export{Ue as H,be as P,qe as S,Le as a};
